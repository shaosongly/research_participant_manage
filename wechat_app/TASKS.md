# 微信小程序访视计划工具 - 任务清单

## 0. 基础准备
- 初始化小程序目录结构与页面骨架
- 配置 `app.json`、`app.js`、`app.wxss`
- 建立 `utils/` 基础工具层
- 引入并验证 npm 构建流程

## 1. 方案管理
### 1.1 方案列表页
- 方案列表 UI（卡片布局）
- 空状态与引导创建
- 删除方案（含确认）
- 进入编辑/生成入口

### 1.2 方案编辑页
- 表单 UI 与校验（名称、总访视次数、频率、窗口）
- 固定/可变频率输入切换
- 固定/可变窗口输入切换
- 保存与更新逻辑

### 1.3 方案数据持久化
- `plans` 存储结构
- 新增/更新/删除/获取列表
- 生成默认模板（可选）

## 2. 访视计划生成
### 2.1 计划生成页
- 方案选择器与首访日期选择器
- 生成按钮与输入校验
- 生成后跳转结果页

### 2.2 计划计算逻辑
- 频率与窗口解析
- 日期计算（base/earliest/latest）
- 访视命名规则解析
- 不可避节假日统计

### 2.3 计划结果页
- 计划摘要卡片
- 计划明细列表
- 节假日高亮
- 保存为历史记录
- 调整首访日期并重新生成

## 3. 节假日管理
### 3.1 节假日基础判断
- 引入 `lunar-javascript`
- 周末判定逻辑

### 3.2 自定义节假日覆盖
- 覆盖列表展示
- 新增/编辑/删除
- 覆盖优先级逻辑

## 4. 历史记录
### 4.1 历史列表页
- 列表展示与筛选
- 删除记录（含确认）
- 进入详情页

### 4.2 历史详情页
- 计划摘要与明细展示
- 导出按钮

### 4.3 历史记录存储策略
- 保存快照结构
- 上限 100 条的清理策略

## 5. 导出与分享
### 5.1 Excel 导出
- 生成二维表格
- 调用 `xlsx` 生成 `.xlsx`
- 写入临时文件并打开

### 5.2 CSV 兜底导出
- `.xlsx` 失败时切换 CSV
- 写入与打开流程

## 6. 通用体验与质量
### 6.1 UI 规范落地
- 统一按钮/卡片/间距
- 统一颜色与字体层级

### 6.2 状态与提示
- 加载/空状态/错误提示
- 导出成功与失败提示

### 6.3 冒烟测试
- 新建方案 -> 生成计划 -> 导出
- 节假日覆盖 -> 计划刷新
- 历史记录保存/删除

